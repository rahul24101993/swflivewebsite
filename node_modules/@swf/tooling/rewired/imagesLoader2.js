// Copyright (c) 2022 Siemens

const { compileSVGToReactComponent } = require( '../js/util' );
const { Stopwatch } = require( './perfUtils' );

/**
 * main function of decl loader
 * @param {string} source input file content
 */
module.exports = function loader( source ) {
    const stopwatch = new Stopwatch( 'imagesLoader2' );
    const resourcePath = this.resource.replace( /\\/g, '/' );
    var callback = this.async();
    compileSVGToReactComponent( source, resourcePath ).then( output => {
        stopwatch.end();
        return callback( null, output );
    } ).catch( error => {
        stopwatch.end();
        return callback( error );
    } );
};

/**
 * Replace all instances of a given string within a larger string.
 *
 * @param {String} input - input string to replace content
 * @param {String} toFind - string to locate
 * @param {String} toReplace - string to replace
 * @return {String} modified string
 */
const replaceAll = ( input, toFind, toReplace ) => {
    let output = input;
    if( output.indexOf( toFind ) > -1 ) {
        output = output.split( toFind ).join( toReplace );
    }
    return output;
};
