const NUMBER_OF_TESTS = 10000;

/**
 * perform test and measure time in ms
 * @param {*} func function to execute
 * @returns promise with total ms time taken
 */
async function perfTest( func ) {
    const start = performance.now();
    await func();
    const end = performance.now();
    return end - start;
}

/**
 * This function runs the performance test for given times default value is 10,000 times, and returns
 * the average in milliseconds.
 */
async function getPerformanceScore( func, noOfTimes ) {
    noOfTimes = noOfTimes ? noOfTimes : NUMBER_OF_TESTS;
    const tests = new Array( noOfTimes ).fill( undefined ).map( async () => perfTest( func ) );
    const results = await Promise.all( tests );
    return results.reduce( ( acc, val ) => acc + val, 0 ) / noOfTimes;
}

module.exports = {
    getPerformanceScore
}
