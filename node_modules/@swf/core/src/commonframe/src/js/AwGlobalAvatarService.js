// Copyright (c) 2021 Siemens

/**
 * @module js/AwGlobalAvatarService
 */
import _ from 'lodash';
import AwAvatar from 'viewmodel/AwAvatarViewModel';
import AwHeaderContext from 'viewmodel/AwHeaderContextViewModel';
import AwCommandBar from 'viewmodel/AwCommandBarViewModel';
import AwLink from 'viewmodel/AwLinkViewModel';

/**
 * render function for Common Global Navigation
 * @param {*} param0 context for render function interpolation
 * @returns {JSX.Element} react component
 */
export const awGlobalAvatarRenderFunction = ( { ctx, actions, fields, viewModel, i18n } ) => {
    let hasThumbnail = _.get( ctx, 'user.hasThumbnail' );
    let typeIconURL = _.get( ctx, 'user.typeIconURL' );
    let thumbnailURL = _.get( ctx, 'user.thumbnailURL' );
    let tcSessionData = _.get( ctx, 'tcSessionData' );
    let cellHeader1 = _.get( ctx, 'user.cellHeader1' );

    const { data } = viewModel;
    const updateHook = { data, actions };
    let avatar;

    if( hasThumbnail  ) {
        avatar = <AwAvatar size='xlarge' source={thumbnailURL} action={actions.userAvatarAction}></AwAvatar>;
    } else if ( cellHeader1 && cellHeader1.length > 0 ) {
        avatar = <AwAvatar size='xlarge' action={actions.userAvatarAction} initials={cellHeader1}></AwAvatar>;
    }
    return (
        // LHN (Bottom) AVATAR AREA which opens LHN Panel
        <div className='sw-column h-12'>
            <div className='sw-row flex-auto'></div>
            <div className='sw-row justify-center'>
                {avatar}
            </div>
            <div className='sw-row justify-center'>
                {
                    tcSessionData &&
                    <AwLink {...fields.userName} action={actions.viewProfile} link-id='avatarPanelUserName'></AwLink>
                }
            </div>
            <div className='align-flex-end'>
                <AwHeaderContext anchor={data.dockUnDockUserSettingsAnchor} updateHook={updateHook}></AwHeaderContext>
                <AwCommandBar anchor='aw_userLink' alignment='VERTICAL' showCommandLabels={true} hideMore={true}></AwCommandBar>
            </div>
        </div>
    );
};
