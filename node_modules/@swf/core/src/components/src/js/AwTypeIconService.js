import awIconSvc from 'js/awIconService';
import cmm from 'soa/kernel/clientMetaModel';
import AwPic from 'viewmodel/AwPicViewModel';

//This component is AW specific, can this be moved to AW
export const awTypeIconRenderFn = ( props ) => {
    const { vmo } = props;

    let typeHierarchy = [];
    if( vmo ) {
        const type = cmm.getType( vmo.uid );
        if( type ) {
            typeHierarchy = type.typeHierarchyArray;
        } else if( vmo.props && vmo.props.type_name ) {
            typeHierarchy.push( vmo.props.type_name.dbValue );
            const parentTypes = vmo.props.parent_types.dbValues;
            for( const parentType in parentTypes ) {
                // parentType is of form "TYPE::Item::Item::WorkspaceObject"
                const arr = parentTypes[ parentType ].split( '::' );
                typeHierarchy.push( arr[ 1 ] );
            }
        }
    }
    const typeIcon = awIconSvc.getTypeIconFileUrlForTypeHierarchy( typeHierarchy );

    return <AwPic className='sw-pic-thumbnail' source={typeIcon}
        alt={vmo && vmo.props && vmo.props.type_name && vmo.props.type_name.uiValue} />;
};
