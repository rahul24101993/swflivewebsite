import { includeComponent } from 'js/moduleLoader';
import declUtils from 'js/declUtils';

export const awCommandSubPanelRenderFunction = ( props ) => {
    const { ...prop } = props;
    const { panelId, subPanelContext } = prop;
    // Nested forms are not allowed in html5 specification, hence converted the form to div.
    // More-over command sub panel is always used inside a command-panel which itself is a form
    return (
        <div name='subPanelForm' className='aw-layout-subPanelContent sw-column'>
            {includeComponent( panelId, { ...subPanelContext, isCommandSubPanel:'true', ...prop } )}
        </div>
    );
};

export const onMount = ( panelId, updateActiveView ) => {
    if( updateActiveView ) {
        let activeView = updateActiveView.activeView;
        const pDispatch = updateActiveView.dispatch;
        if( pDispatch ) {
            // Only Change the activeView, iff activeView is not defined ( by consumer through aw-init or Command Panel)
            activeView = declUtils.isNil( activeView ) ? panelId : activeView;
            pDispatch( { value: { 'data.activeView': activeView } } );
        }
    }
};
