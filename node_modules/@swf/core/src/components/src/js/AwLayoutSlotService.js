import cfgSvc from 'js/configurationService';
import { updateShortConditions } from 'js/commandConfigUtils.service';
import AwLayoutSlotInclude from 'viewmodel/AwLayoutSlotIncludeViewModel';

export const awLayoutSlotRenderFunction = ( props ) => {
    const { viewModel, name, context } = props;
    const { data } = viewModel;
    const { allSlotsJson } = data;
    return allSlotsJson ? <AwLayoutSlotInclude name={name} context={context} allSlotsJson={allSlotsJson}></AwLayoutSlotInclude> : '';
};

const loadLayoutSlots = async () => {
    return await cfgSvc.getCfg( 'layoutSlots' ).then( allSlotsJson => {
        if( allSlotsJson.slots ) {
            updateShortConditions( allSlotsJson, allSlotsJson.slots );
            return allSlotsJson;
        }
    } );
};

export const initialize = () => {
    return loadLayoutSlots().then( allSlotsJson => {
        return allSlotsJson;
    } );
};
