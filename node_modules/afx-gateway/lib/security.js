const trace = require( 'debug' )( 'expressServer:security' );

/**
 * @param {Object} app - express application
 * @param {Object} logger - logger
 * @param {Object} options - options
 */
module.exports = function( app, logger, {
    helmet = null,
    cors = null,
    csurf = null
} ) {
    trace( 'helmet', helmet );
    trace( 'cors', cors );
    trace( 'csurf', csurf );

    // https://expressjs.com/en/advanced/best-practice-security.html

    if( helmet ) {
        // https://www.npmjs.com/package/helmet
        // https://helmetjs.github.io/
        // https://github.com/helmetjs/helmet
        app.use( require( 'helmet' )( helmet ) );
        logger.debug( '+ security: helmet enabled' );
    }

    if( cors ) {
        // https://www.npmjs.com/package/cors
        // https://github.com/expressjs/cors
        app.use( require( 'cors' )() );
        logger.debug( '+ security: cors enabled' );
    }

    if( csurf ) {
        // https://www.npmjs.com/package/csurf
        // https://github.com/expressjs/csurf
        app.use( require( 'csurf' )() );
        logger.debug( '+ security: csurf enabled' );
    }
};
