const trace = require( 'debug' )( 'expressServer:sso' );
const ssoAuth = require( __dirname + '/ssoAuth' );
/**
 * @param {Object} app - express application
 * @param {Object} logger - logger
 * @param {Object} options - options
 */
module.exports = function( app, logger, options = {} ) {
    trace( 'options', options );

    let ssoRoutes = {
        awSSOLogin:{
            path:'/AWSSOLogin',
            target: ssoAuth.awSSOLoginService
        },
        auth:{
            path : '/auth',
            target: ssoAuth.ssoPerformLoginPage
        },
        reauth:{
            path: '/reauth',
            target: ssoAuth.ssoPerformLoginPage
        },
        logoff:{
            path: '/logoff',
            target: ssoAuth.ssoPerformLogoutPage
        }
    };

    if( options.tcSSOAppID === '' || options.tcSSOURL === '' ) { return; }

    for( const route of Object.values( ssoRoutes ) ) {
        app.use( route.path, route.target );
    }

    logger.info( '+ AW SSO enabled' );
};

