{"ast":null,"code":"/* eslint-disable jsx-a11y/no-static-element-interactions */ /* eslint-disable jsx-a11y/anchor-is-valid */import AwIcon from'viewmodel/AwIconViewModel';import AwPopup from'viewmodel/AwPopupViewModel';import{registerDynImportEntry,includeComponent}from'js/moduleLoader';import{executeCommand}from'js/command.service';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";registerDynImportEntry('viewmodel/AwLinkPopupMenuViewModel',()=>import('viewmodel/AwLinkPopupMenuViewModel'));/**\n * 'both' show both icon and text\n * 'iconOnly' only show icon\n * 'textOnly' only show text\n */const _defaultIconOptions={enabled:true,title:'textOnly',cell:'textOnly',arrow:true};const processIconOptions=iconOptions=>{let res={showLinkText:true,showCellText:true,arrow:true};let result={..._defaultIconOptions};iconOptions&&Object.assign(result,iconOptions);const{enabled,title,cell}=result;if(enabled){res.showLinkIcon=['both','iconOnly'].indexOf(title)>-1;res.showLinkText=['both','textOnly'].indexOf(title)>-1;res.showCellIcon=['both','iconOnly'].indexOf(cell)>-1;res.showCellText=['both','textOnly'].indexOf(cell)>-1;res.arrow=result.arrow;}return res;};const initializeDataProvider=(dataProvider,data,dispatch,initialValue)=>{if(!dataProvider){return;}if(!data._dpInitialized){dataProvider.resetDataProvider();dispatch({path:'data._dpInitialized',value:true});// Support pre-selection if defined and valid\nif(initialValue){dataProvider.selectionModel.setSelection(initialValue);}}};const updateCallback=dispatch=>value=>{dispatch({path:'data._title',value});};export const awLinkRenderFunction=props=>{const{viewModel,ctxMin,actions,i18n,fields,grids,formProp,messages,dataprovider:dataProvider,runActionWithViewModel,...prop}=props;const{data,dispatch}=viewModel;const{id,ellipsis,fielddata,linkOptions,displayProperty,selectedprop,commandId}=prop;const{hasPopup,popupOptions,view,content,iconOptions}=linkOptions||{};let{linkPopup}=actions;let disabled=!props.fielddata.isEnabled;const hooks={whenOpened:()=>initializeDataProvider(dataProvider,data,dispatch,prop.value)};const handleClick=event=>{if(disabled||event.key&&event.key!=='Enter'&&event.key!==' '){return;}event.preventDefault();if(hasPopup){// enable application to override popupOptions\nif(popupOptions&&popupOptions.hooks&&popupOptions.hooks.whenOpened){popupOptions.hooks.whenOpened.push(hooks.whenOpened);}let finalPopupOptions={...popupOptions};if(finalPopupOptions===undefined){finalPopupOptions={};}if(finalPopupOptions.selectedElementCSS===undefined){finalPopupOptions.selectedElementCSS='.aw-widgets-cellListItemSelected';finalPopupOptions.className='sw-lov-popup';}linkPopup.show({hooks,...finalPopupOptions});}else if(commandId){executeCommand(commandId,null,props,prop,runActionWithViewModel);}else if(prop.action){prop.action();}};const propKey=fielddata.uiValue?'uiValue':'propertyDisplayName';const title=data._title||fielddata[propKey];// conditional tab navigable\nconst tabIndex=disabled?'-1':'0';const clz=\"\".concat(ellipsis?'ellipsis':'',\" \").concat(disabled?'disabled':'');// if ellipsis defined, make sure link take the full width so the ellipsis will take effect\nconst width=ellipsis?'w-12':'';// simple link\nif(!hasPopup){//We really ought not to use <a></a> tag for button behavior\nreturn/*#__PURE__*/_jsx(\"div\",{style:prop.style,className:\"aw-link \".concat(width,\" \").concat(clz),\"link-id\":id,\"data-id\":id,\"data-locator\":id,children:/*#__PURE__*/_jsx(\"a\",{\"aria-label\":title,className:'sw-aria-border',onClick:handleClick,onKeyDown:handleClick,title:title,tabIndex:tabIndex,children:title})});}// link with popup\nconst options=processIconOptions(iconOptions);const IncludedView=view||'AwLinkPopupMenu';// AwLinkPopupMenu is the default view\nconst childProps={linkProp:prop,dataProvider,propKey,options,linkPopup,displayProperty,updateCallback:updateCallback(dispatch)};const getContent=()=>{// use transclude content first\nlet result=content;if(!content){result=includeComponent(IncludedView,childProps);}return result;};const finalPopupOptions={...linkPopup.options,...popupOptions};// We really ought not to use <a></a> tag for button behavior\nreturn/*#__PURE__*/_jsxs(\"div\",{className:width,style:prop.style,children:[/*#__PURE__*/_jsxs(\"div\",{\"data-locator\":id||prop.linkPopupMenuId,ref:linkPopup.reference,role:\"button\",tabIndex:tabIndex,className:\"sw-aria-border aw-link aw-link-with-popup \".concat(clz),onClick:handleClick,onKeyDown:handleClick,children:[options.showLinkIcon&&fielddata.iconName&&/*#__PURE__*/_jsx(AwIcon,{iconId:fielddata.iconName,className:\"aw-base-icon aw-linkIcon \".concat(!options.showLinkText?'aw-linkIconOnly':'')}),options.showLinkText&&/*#__PURE__*/_jsx(\"a\",{title:title,children:title}),options.arrow&&/*#__PURE__*/_jsx(AwIcon,{className:\"aw-base-icon aw-link-arrow\",iconId:\"miscDownArrow_uxRefresh\"})]}),linkPopup.open&&/*#__PURE__*/_jsx(AwPopup,{...finalPopupOptions,children:getContent()})]});};","map":null,"metadata":{},"sourceType":"module"}