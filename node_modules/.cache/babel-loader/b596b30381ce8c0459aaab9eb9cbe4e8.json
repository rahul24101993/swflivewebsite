{"ast":null,"code":"// Copyright (c) 2021 Siemens\n/* eslint-disable react/display-name */ /* eslint-disable react-hooks/rules-of-hooks */ /**\n * @module js/awHighlightPropertyHtmlHOC\n */import React,{useEffect}from'react';import appCtxService from'js/appCtxService';import sanitizer from'js/sanitizer';import{convertToHtml}from'js/reactHelper';import _ from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";const AwHighlightPropertyHtmlDisplayName='AwHighlightPropertyHtml';const AwParseHtmlDisplayName='AwParseHtml';const awHighlightPropertyHtmlHOC=Component=>{// https://reactjs.org/docs/forwarding-refs.html#forwarding-refs-to-dom-components\nreturn/*#__PURE__*/React.forwardRef((_ref,ref)=>{let{children,...props}=_ref;let{awHighlightPropertyHtml,displayVal,awParseHtml,...finalProps}=props;!ref&&(ref=React.useRef(null));useEffect(()=>{if(ref.current){var parsedHtml=displayVal;let highlighter=appCtxService.getCtx('highlighter');if(parsedHtml){parsedHtml=_.isNumber(parsedHtml)?String(parsedHtml):parsedHtml;parsedHtml=sanitizer.htmlEscapeAllowEntities(parsedHtml,true,true);if(highlighter){parsedHtml=parsedHtml.replace(highlighter.regEx,highlighter.style);}parsedHtml=!parsedHtml?'':parsedHtml;if(_.isEmpty(ref.current.innerHTML)||displayVal!==parsedHtml){let isRichText=props[_.kebabCase('isRichText')];isRichText=isRichText&&isRichText.match(/true/i);ref.current.innerHTML=isRichText?convertToHtml(parsedHtml):parsedHtml;}}}},[displayVal]);if(awHighlightPropertyHtml||awParseHtml){if(awHighlightPropertyHtml&&typeof Component==='object'){finalProps.awHighlightPropertyHtml=awHighlightPropertyHtml;Component.displayName=AwHighlightPropertyHtmlDisplayName;}else if(awParseHtml&&typeof Component==='object'){finalProps.awParseHtml=awParseHtml;Component.displayName=AwParseHtmlDisplayName;}if(typeof Component==='object'){finalProps.displayval=displayVal;}return/*#__PURE__*/_jsx(Component,{...finalProps,ref:ref,children:children});}return null;});};export default awHighlightPropertyHtmlHOC;","map":null,"metadata":{},"sourceType":"module"}