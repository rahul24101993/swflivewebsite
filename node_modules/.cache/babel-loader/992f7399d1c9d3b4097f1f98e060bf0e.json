{"ast":null,"code":"// Copyright (c) 2020 Siemens\n\n/**\n * General profier for async worker\n *\n * https://github.com/GoogleChromeLabs/tti-polyfill\n *\n * @module js/splmStatsProfiler\n */\nimport { now } from 'js/splmStatsUtils';\nimport { LAST_DIGEST_BUSY_WAIT } from 'js/splmStatsConstants'; // DOM Node type in browser\n\nexport const STATE = {\n  IDLE: 0,\n  HOLD: 1,\n  WAIT: 2,\n  DONE: 3\n}; // pre save origin set timeout call\n\nconst globalSetTimeout = setTimeout;\nexport const createProfiler = function () {\n  let watchers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  let interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : LAST_DIGEST_BUSY_WAIT;\n\n  let _promise;\n\n  let _state = STATE.IDLE;\n  const _watchers = [...watchers]; // addWatcher intreface to add more flexibility\n\n  const addWatcher = watcher => _watchers.push(watcher);\n\n  const profile = () => {\n    _promise = _promise || new Promise((resolve, reject) => {\n      // start time\n      const startTime = now();\n\n      const completePageLoad = () => {\n        _watchers.forEach(watcher => {\n          watcher.unregister();\n        }); // WAIT => DONE\n\n\n        _state = STATE.DONE;\n        resolve(now() - startTime - interval);\n      };\n\n      let timeoutID = globalSetTimeout(completePageLoad, interval);\n      let _requestCnt = 0;\n\n      const _onStart = () => {\n        if (_requestCnt === 0) {\n          timeoutID = clearTimeout(timeoutID); // WAIT => HOLD\n\n          _state = STATE.HOLD;\n        }\n\n        _requestCnt++; // console.log( `Profiler rquestCnt: ${_requestCnt} (onStart)` );\n      };\n\n      const _onDone = () => {\n        _requestCnt = _requestCnt > 0 ? _requestCnt - 1 : 0;\n\n        if (_requestCnt === 0) {\n          // for the case onDone come in 1stly as side effect.\n          timeoutID = clearTimeout(timeoutID);\n          timeoutID = globalSetTimeout(completePageLoad, interval); // HOLD => WAIT\n\n          _state = STATE.WAIT;\n        } // console.log( `Profiler rquestCnt: ${_requestCnt} (onDone)` );\n\n      };\n\n      _watchers.forEach(watcher => {\n        watcher.register(_onStart, _onDone);\n      }); // IDLE => WAIT\n\n\n      _state = STATE.WAIT;\n    });\n    return _promise;\n  };\n\n  return {\n    get state() {\n      return _state;\n    },\n\n    get active() {\n      return _state === STATE.HOLD || _state === STATE.WAIT;\n    },\n\n    addWatcher,\n    profile\n  };\n};\n\nconst Profiler = () => createProfiler([]);\n\n_c2 = Profiler;\n_c = Profiler;\nexport default Profiler;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profiler\");\n\nvar _c2;\n\n$RefreshReg$(_c2, \"Profiler\");","map":{"version":3,"sources":["C:/Users/rahukl57/Desktop/SWF/CreatingOwnComponentUsingJsx/node_modules/@swf/core/src/plstats/src/js/splmStatsProfiler.js"],"names":["STATE","IDLE","HOLD","WAIT","DONE","globalSetTimeout","createProfiler","watchers","interval","LAST_DIGEST_BUSY_WAIT","_state","_watchers","addWatcher","watcher","profile","_promise","startTime","now","completePageLoad","resolve","timeoutID","_requestCnt","_onStart","clearTimeout","_onDone","Profiler"],"mappings":"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","sourcesContent":["// Copyright (c) 2020 Siemens\n\n/**\n * General profier for async worker\n *\n * https://github.com/GoogleChromeLabs/tti-polyfill\n *\n * @module js/splmStatsProfiler\n */\nimport { now } from 'js/splmStatsUtils';\nimport { LAST_DIGEST_BUSY_WAIT } from 'js/splmStatsConstants';\n\n// DOM Node type in browser\nexport const STATE = {\n    IDLE: 0,\n    HOLD: 1,\n    WAIT: 2,\n    DONE: 3\n};\n\n// pre save origin set timeout call\nconst globalSetTimeout = setTimeout;\n\nexport const createProfiler = ( watchers = [], interval = LAST_DIGEST_BUSY_WAIT ) => {\n    let _promise;\n    let _state = STATE.IDLE;\n\n    const _watchers = [ ...watchers ];\n\n    // addWatcher intreface to add more flexibility\n    const addWatcher = watcher => _watchers.push( watcher );\n\n    const profile = () => {\n        _promise = _promise || new Promise( ( resolve, reject ) => {\n            // start time\n            const startTime = now();\n\n            const completePageLoad = () => {\n                _watchers.forEach( watcher => {\n                    watcher.unregister();\n                } );\n\n                // WAIT => DONE\n                _state = STATE.DONE;\n\n                resolve( now() - startTime - interval );\n            };\n\n            let timeoutID = globalSetTimeout( completePageLoad, interval );\n\n            let _requestCnt = 0;\n            const _onStart = () => {\n                if( _requestCnt === 0 ) {\n                    timeoutID = clearTimeout( timeoutID );\n\n                    // WAIT => HOLD\n                    _state = STATE.HOLD;\n                }\n                _requestCnt++;\n                // console.log( `Profiler rquestCnt: ${_requestCnt} (onStart)` );\n            };\n\n            const _onDone = () => {\n                _requestCnt = _requestCnt > 0 ? _requestCnt - 1 : 0;\n                if( _requestCnt === 0 ) {\n                    // for the case onDone come in 1stly as side effect.\n                    timeoutID = clearTimeout( timeoutID );\n                    timeoutID = globalSetTimeout( completePageLoad, interval );\n\n                    // HOLD => WAIT\n                    _state = STATE.WAIT;\n                }\n                // console.log( `Profiler rquestCnt: ${_requestCnt} (onDone)` );\n            };\n\n            _watchers.forEach( watcher => {\n                watcher.register( _onStart, _onDone );\n            } );\n\n            // IDLE => WAIT\n            _state = STATE.WAIT;\n        } );\n        return _promise;\n    };\n\n    return {\n        get state() {\n            return _state;\n        },\n        get active() {\n            return _state === STATE.HOLD || _state === STATE.WAIT;\n        },\n        addWatcher,\n        profile\n    };\n};\n\nconst Profiler = () => createProfiler( [] );\nexport default Profiler;\n"]},"metadata":{},"sourceType":"module"}