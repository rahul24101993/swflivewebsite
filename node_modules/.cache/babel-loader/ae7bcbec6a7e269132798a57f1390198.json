{"ast":null,"code":"// Copyright (c) 2021 Siemens\n\n/**\n * @module js/navigationTokenService\n */\nimport cfgSvc from 'js/configurationService';\nimport cdm from 'soa/kernel/clientDataModel';\nimport adapterParserService from 'js/adapterParserService';\nimport declarativeDataCtxSvc from 'js/declarativeDataCtxService';\nimport navigationService from 'js/navigationService';\nimport viewModelProcessingFactory from 'js/viewModelProcessingFactory';\nimport viewModelObjectService from 'js/viewModelObjectService';\nimport _ from 'lodash';\n\nvar _navigationToken;\n\nvar exports = {}; // A property is which type of BO will be driven by solution config , based on the same naivigationToken will be associated in the href attribute of\n// anchor tag for the particular property\n// Example :\n\n/* [{\"conditions\": {\"$and\": [{ \"modelType.typeHierarchyArray\": { \"$in\": \"ImanFile\" }}]},\n     \"navigations\": {\"navigateTo\": \"downloadFile\",\"navigationParams\": {\"uid\": \"{{navContext.vmo.uid}}\"}  }\n    },\n    {\"conditions\": {\"modelType.typeHierarchyArray\": {\"$notin\": \"ImanFile\"}},\n     \"navigations\": {\"navigateTo\": \"com_siemens_splm_clientfx_tcui_xrt_showObject\",\"navigationParams\": {\"uid\": \"{{navContext.vmo.uid}}\" }  }\n    }\n    ]\n*/\n\nexport const getNavigationContent = function (scope, dbValue, vmo) {\n  //The scope input is not needed anymore, verify the other usecases which leverages this api\n  //and this can be cleaned up\n  var conditionVerdict = {};\n\n  if (vmo && vmo.navigation) {\n    return navigationService.navigate(vmo.navigation[0].navigateTo, vmo.navigation[0].navigationParams).then(function (urlDetails) {\n      return urlDetails;\n    });\n  }\n\n  return cfgSvc.getCfg('navigationURLToken').then(function (token) {\n    _navigationToken = token;\n\n    if (_navigationToken && _navigationToken.length > 0) {\n      // the below cdm check has been added to avoid any console errors when an OBJECT prop is not a VMO which ultimately shows up console errors\n      // emanating out of a logger.error statement in constructViewModelObjectFromModelObject ()\n      // it will be removed once cdm dependency is taken out from SWF\n      if (cdm.getObject(dbValue) !== null) {\n        var propVmo = viewModelObjectService.constructViewModelObjectFromModelObject(cdm.getObject(dbValue), null, null, null, true);\n        scope.navContext = {\n          vmo: propVmo\n        };\n        conditionVerdict = adapterParserService.applyConditions(propVmo, _navigationToken);\n\n        if (conditionVerdict && conditionVerdict.verdict) {\n          var inputData = _.cloneDeep(_navigationToken[conditionVerdict.index].navigations.navigationParams);\n\n          try {\n            //Revisit: Need to evluate if there is a better way of handling this\n            //For now, creating a temporary declviewmodel as the 'applyscope' method expects\n            //a declviewmodel\n            if (inputData && !_.isEmpty(inputData)) {\n              var declViewModel = viewModelProcessingFactory.createDeclViewModel({});\n              declarativeDataCtxSvc.applyScope(declViewModel, inputData, null, scope, null);\n\n              declViewModel._internal.destroy();\n            } else {\n              inputData = {\n                uid: propVmo.uid\n              };\n            }\n          } catch (error) {\n            throw new Error(error);\n          }\n\n          return declarativeDataCtxSvc.applyExpression(inputData).then(function () {\n            return navigationService.navigate(_navigationToken[conditionVerdict.index].navigations, inputData).then(function (urlDetails) {\n              return urlDetails;\n            });\n          });\n        }\n      }\n    }\n\n    return undefined;\n  });\n};\nexports = {\n  getNavigationContent\n};\nexport default exports;","map":{"version":3,"names":["cfgSvc","cdm","adapterParserService","declarativeDataCtxSvc","navigationService","viewModelProcessingFactory","viewModelObjectService","_","_navigationToken","exports","getNavigationContent","scope","dbValue","vmo","conditionVerdict","navigation","navigate","navigateTo","navigationParams","then","urlDetails","getCfg","token","length","getObject","propVmo","constructViewModelObjectFromModelObject","navContext","applyConditions","verdict","inputData","cloneDeep","index","navigations","isEmpty","declViewModel","createDeclViewModel","applyScope","_internal","destroy","uid","error","Error","applyExpression","undefined"],"sources":["C:/Users/rahukl57/Desktop/SWF/CreatingOwnComponentUsingJsx/node_modules/@swf/core/src/kernel/src/js/navigationTokenService.js"],"sourcesContent":["// Copyright (c) 2021 Siemens\n\n/**\n * @module js/navigationTokenService\n */\nimport cfgSvc from 'js/configurationService';\nimport cdm from 'soa/kernel/clientDataModel';\nimport adapterParserService from 'js/adapterParserService';\nimport declarativeDataCtxSvc from 'js/declarativeDataCtxService';\nimport navigationService from 'js/navigationService';\nimport viewModelProcessingFactory from 'js/viewModelProcessingFactory';\nimport viewModelObjectService from 'js/viewModelObjectService';\nimport _ from 'lodash';\n\nvar _navigationToken;\nvar exports = {};\n\n// A property is which type of BO will be driven by solution config , based on the same naivigationToken will be associated in the href attribute of\n// anchor tag for the particular property\n\n// Example :\n/* [{\"conditions\": {\"$and\": [{ \"modelType.typeHierarchyArray\": { \"$in\": \"ImanFile\" }}]},\n     \"navigations\": {\"navigateTo\": \"downloadFile\",\"navigationParams\": {\"uid\": \"{{navContext.vmo.uid}}\"}  }\n    },\n    {\"conditions\": {\"modelType.typeHierarchyArray\": {\"$notin\": \"ImanFile\"}},\n     \"navigations\": {\"navigateTo\": \"com_siemens_splm_clientfx_tcui_xrt_showObject\",\"navigationParams\": {\"uid\": \"{{navContext.vmo.uid}}\" }  }\n    }\n    ]\n*/\nexport const getNavigationContent = function( scope, dbValue, vmo ) {\n    //The scope input is not needed anymore, verify the other usecases which leverages this api\n    //and this can be cleaned up\n\n    var conditionVerdict = {};\n\n    if( vmo && vmo.navigation ) {\n        return navigationService.navigate( vmo.navigation[ 0 ].navigateTo, vmo.navigation[ 0 ].navigationParams ).then( function( urlDetails ) {\n            return urlDetails;\n        } );\n    }\n\n    return cfgSvc.getCfg( 'navigationURLToken' ).then( function( token ) {\n        _navigationToken = token;\n        if( _navigationToken && _navigationToken.length > 0 ) {\n            // the below cdm check has been added to avoid any console errors when an OBJECT prop is not a VMO which ultimately shows up console errors\n            // emanating out of a logger.error statement in constructViewModelObjectFromModelObject ()\n            // it will be removed once cdm dependency is taken out from SWF\n            if( cdm.getObject( dbValue ) !== null ) {\n                var propVmo = viewModelObjectService.constructViewModelObjectFromModelObject( cdm.getObject( dbValue ), null, null, null, true );\n\n                scope.navContext = {\n                    vmo: propVmo\n                };\n                conditionVerdict = adapterParserService.applyConditions( propVmo, _navigationToken );\n                if( conditionVerdict && conditionVerdict.verdict ) {\n                    var inputData = _.cloneDeep( _navigationToken[ conditionVerdict.index ].navigations.navigationParams );\n                    try {\n                        //Revisit: Need to evluate if there is a better way of handling this\n                        //For now, creating a temporary declviewmodel as the 'applyscope' method expects\n                        //a declviewmodel\n                        if( inputData && !_.isEmpty( inputData ) ) {\n                            var declViewModel = viewModelProcessingFactory.createDeclViewModel( {} );\n                            declarativeDataCtxSvc.applyScope( declViewModel, inputData, null, scope, null );\n                            declViewModel._internal.destroy();\n                        } else {\n                            inputData = {\n                                uid: propVmo.uid\n                            };\n                        }\n                    } catch ( error ) {\n                        throw new Error( error );\n                    }\n                    return declarativeDataCtxSvc.applyExpression( inputData ).then( function() {\n                        return navigationService.navigate( _navigationToken[ conditionVerdict.index ].navigations, inputData ).then( function( urlDetails ) {\n                            return urlDetails;\n                        } );\n                    } );\n                }\n            }\n        }\n        return undefined;\n    } );\n};\n\nexports = {\n    getNavigationContent\n};\nexport default exports;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}