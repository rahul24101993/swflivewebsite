{"ast":null,"code":"/* eslint-disable no-console */\n// Copyright (c) 2020 Siemens\n\n/* eslint-env es6 */\nimport _ from 'lodash';\nimport eventBus from 'js/eventBus';\nimport appCtxService from 'js/appCtxService';\n/**\n * awStateService\n *\n * @module js/awStateService\n */\n\nlet routerStateSvc;\nlet stateServiceObject = {\n  instance: {\n    //test purpose only, will be overriden by router\n    go: () => {},\n    params: {},\n    transitionHooks: {\n      onEnter: () => {},\n      onSuccess: () => {},\n      onBefore: () => {}\n    }\n  }\n};\n\nconst subscribeHooks = (transitionService, locationService) => {\n  if (locationService.path() && !/^(\\/|undefined)/.test(locationService.path()) && window && window.location) {\n    // The following block is to support remapping of \"invalid\" URLs\n    // #state -> #/state\n    // #state;uid=123 => #/state?uid=123\n    const pathElems = locationService.path().split(';');\n    let newPath = pathElems[0];\n\n    for (let ii = 1; ii < pathElems.length; ii++) {\n      if (ii === 1) {\n        newPath += `?${pathElems[ii]}`;\n      } else {\n        newPath += `&${pathElems[ii]}`;\n      }\n    } // Update URL & reload page\n\n\n    window.location.hash = `#/${newPath}`;\n    window.location.reload(false); // force page refresh\n  }\n\n  eventBus.publish('transitionHooks', {\n    transitionService\n  });\n  locationService.onChange(event => {\n    eventBus.publish('locationChangeSuccess', {\n      event: event,\n      newUrl: event.newURL,\n      oldUrl: event.oldURL\n    }); // Update the state params on appCtx\n\n    updateStateParamsOnAppCtx(stateServiceObject.instance.params); // support legacy usages of location change complete event\n\n    eventBus.publish('LOCATION_CHANGE_COMPLETE');\n  });\n  transitionService.onSuccess({}, transition => {\n    // Update the state params on appCtx\n    updateStateParamsOnAppCtx(transition.params());\n    eventBus.publish('stateChangeSuccess', {\n      transitionParams: transition.params()\n    });\n  });\n};\n\nexport const initializeStateService = router => {\n  routerStateSvc = router.stateService;\n  stateServiceObject.instance = {\n    go: routerStateSvc.go,\n    get: routerStateSvc.get,\n    href: routerStateSvc.href,\n\n    get current() {\n      return routerStateSvc.current;\n    },\n\n    get params() {\n      return _.reduce(routerStateSvc.params, (sum, curr, key) => ({ ...sum,\n        [key]: curr && typeof curr === 'string' ? decodeURIComponent(encodeURIComponent(curr)) : curr\n      }), {});\n    },\n\n    transitionTo: routerStateSvc.transitionTo,\n    transitionHooks: {\n      /**\n       * Replacement of $stateChangeStart\n       */\n      onEnter: router.transitionService.onEnter,\n\n      /**\n       * Replacement of $stateChangeSuccess\n       */\n      onSuccess: router.transitionService.onSuccess,\n\n      /**\n       * Replacement of $stateChangeError\n       */\n      onError: router.transitionService.onError,\n      onBefore: router.transitionService.onBefore\n    },\n\n    /**\n     * Replacement of $stateNotFound\n     */\n    onInvalid: routerStateSvc.onInvalid,\n    reload: routerStateSvc.reload\n  };\n  subscribeHooks(router.transitionService, router.locationService); // Suppress console errors, we are deliberately aborting the state transition at few places\n\n  routerStateSvc.defaultErrorHandler(function (error) {// do nothing- suppress errors\n  });\n};\n\nconst updateStateParamsOnAppCtx = stateParams => {\n  var processParameters = function processParameters(stateParams) {\n    return Object.keys(stateParams) // Filter parameters that are not set\n    .filter(function (param) {\n      return stateParams[param];\n    }) // Build the new object\n    .reduce(function (acc, nxt) {\n      acc[nxt] = stateParams[nxt];\n      return acc;\n    }, {});\n  };\n\n  appCtxService.registerCtx('state', {\n    params: stateParams,\n    processed: processParameters(stateParams)\n  });\n};\n\nexport default stateServiceObject;","map":{"version":3,"names":["_","eventBus","appCtxService","routerStateSvc","stateServiceObject","instance","go","params","transitionHooks","onEnter","onSuccess","onBefore","subscribeHooks","transitionService","locationService","path","test","window","location","pathElems","split","newPath","ii","length","hash","reload","publish","onChange","event","newUrl","newURL","oldUrl","oldURL","updateStateParamsOnAppCtx","transition","transitionParams","initializeStateService","router","stateService","get","href","current","reduce","sum","curr","key","decodeURIComponent","encodeURIComponent","transitionTo","onError","onInvalid","defaultErrorHandler","error","stateParams","processParameters","Object","keys","filter","param","acc","nxt","registerCtx","processed"],"sources":["C:/Users/rahukl57/Desktop/SWF/CreatingOwnComponentUsingJsx/node_modules/@swf/core/src/services/src/js/awStateService.js"],"sourcesContent":["/* eslint-disable no-console */\n// Copyright (c) 2020 Siemens\n/* eslint-env es6 */\nimport _ from 'lodash';\nimport eventBus from 'js/eventBus';\nimport appCtxService from 'js/appCtxService';\n\n/**\n * awStateService\n *\n * @module js/awStateService\n */\nlet routerStateSvc;\nlet stateServiceObject = {\n    instance: {\n        //test purpose only, will be overriden by router\n        go: () => {},\n        params: {},\n        transitionHooks: {\n            onEnter: () => {},\n            onSuccess: () => {},\n            onBefore: () => {}\n        }\n    }\n};\n\nconst subscribeHooks = ( transitionService, locationService ) => {\n    if( locationService.path() && !/^(\\/|undefined)/.test( locationService.path() ) &&\n        window && window.location ) {\n        // The following block is to support remapping of \"invalid\" URLs\n        // #state -> #/state\n        // #state;uid=123 => #/state?uid=123\n        const pathElems = locationService.path().split( ';' );\n        let newPath = pathElems[ 0 ];\n        for( let ii = 1; ii < pathElems.length; ii++ ) {\n            if( ii === 1 ) {\n                newPath += `?${pathElems[ii]}`;\n            } else {\n                newPath += `&${pathElems[ii]}`;\n            }\n        }\n        // Update URL & reload page\n        window.location.hash = `#/${newPath}`;\n        window.location.reload( false ); // force page refresh\n    }\n    eventBus.publish( 'transitionHooks', {\n        transitionService\n    } );\n    locationService.onChange( ( event ) => {\n        eventBus.publish( 'locationChangeSuccess', {\n            event: event,\n            newUrl: event.newURL,\n            oldUrl: event.oldURL\n        } );\n        // Update the state params on appCtx\n        updateStateParamsOnAppCtx( stateServiceObject.instance.params );\n        // support legacy usages of location change complete event\n        eventBus.publish( 'LOCATION_CHANGE_COMPLETE' );\n    } );\n    transitionService.onSuccess( {}, ( transition ) => {\n        // Update the state params on appCtx\n        updateStateParamsOnAppCtx( transition.params() );\n        eventBus.publish( 'stateChangeSuccess', {\n            transitionParams: transition.params()\n        } );\n    } );\n};\nexport const initializeStateService = ( router ) => {\n    routerStateSvc = router.stateService;\n    stateServiceObject.instance = {\n        go: routerStateSvc.go,\n        get: routerStateSvc.get,\n        href: routerStateSvc.href,\n        get current() {\n            return routerStateSvc.current;\n        },\n        get params() {\n            return _.reduce( routerStateSvc.params, ( sum, curr, key ) => ( {\n                ...sum,\n                [ key ]: curr && typeof curr === 'string' ? decodeURIComponent( encodeURIComponent( curr ) ) : curr\n            } ), {} );\n        },\n        transitionTo: routerStateSvc.transitionTo,\n        transitionHooks: {\n            /**\n             * Replacement of $stateChangeStart\n             */\n            onEnter: router.transitionService.onEnter,\n            /**\n             * Replacement of $stateChangeSuccess\n             */\n            onSuccess: router.transitionService.onSuccess,\n            /**\n             * Replacement of $stateChangeError\n             */\n            onError: router.transitionService.onError,\n            onBefore: router.transitionService.onBefore\n        },\n        /**\n         * Replacement of $stateNotFound\n         */\n        onInvalid: routerStateSvc.onInvalid,\n        reload : routerStateSvc.reload\n    };\n    subscribeHooks( router.transitionService, router.locationService );\n    // Suppress console errors, we are deliberately aborting the state transition at few places\n    routerStateSvc.defaultErrorHandler( function( error ) {\n        // do nothing- suppress errors\n    } );\n};\n\nconst updateStateParamsOnAppCtx = ( stateParams ) => {\n    var processParameters = function processParameters( stateParams ) {\n        return Object.keys( stateParams ) // Filter parameters that are not set\n            .filter( function( param ) {\n                return stateParams[ param ];\n            } ) // Build the new object\n            .reduce( function( acc, nxt ) {\n                acc[ nxt ] = stateParams[ nxt ];\n                return acc;\n            }, {} );\n    };\n\n    appCtxService.registerCtx( 'state', {\n        params: stateParams,\n        processed: processParameters( stateParams )\n    } );\n};\n\nexport default stateServiceObject;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}