{"ast":null,"code":"// Copyright (c) 2020 Siemens\n/* eslint-env es6 */ /* eslint-disable require-jsdoc */import _ from'lodash';/**\n * Date filter service.\n *\n * @module js/awDateFilterService\n */const DATETIME_FORMATS={AMPMS:['AM','PM'],DAY:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],ERANAMES:['Before Christ','Anno Domini'],ERAS:['BC','AD'],FIRSTDAYOFWEEK:6,MONTH:['January','February','March','April','May','June','July','August','September','October','November','December'],SHORTDAY:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],SHORTMONTH:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],STANDALONEMONTH:['January','February','March','April','May','June','July','August','September','October','November','December'],WEEKENDRANGE:[5,6],fullDate:'EEEE, MMMM d, y',longDate:'MMMM d, y',medium:'MMM d, y h:mm:ss a',mediumDate:'MMM d, y',mediumTime:'h:mm:ss a',short:'M/d/yy h:mm a',shortDate:'M/d/yy',shortTime:'h:mm a'};let DATE_FORMATS_SPLIT=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\\s\\S]*)/;let NUMBER_STRING=/^-?\\d+$/;var R_ISO8601_STR=/^(\\d{4})-?(\\d\\d)-?(\\d\\d)(?:T(\\d\\d)(?::?(\\d\\d)(?::?(\\d\\d)(?:\\.(\\d+))?)?)?(Z|([+-])(\\d\\d):?(\\d\\d))?)?$/;var DATE_FORMATS={yyyy:dateGetter('FullYear',4,0,false,true),yy:dateGetter('FullYear',2,0,true,true),y:dateGetter('FullYear',1,0,false,true),MMMM:dateStrGetter('Month'),MMM:dateStrGetter('Month',true),MM:dateGetter('Month',2,1),M:dateGetter('Month',1,1),LLLL:dateStrGetter('Month',false,true),dd:dateGetter('Date',2),d:dateGetter('Date',1),HH:dateGetter('Hours',2),H:dateGetter('Hours',1),hh:dateGetter('Hours',2,-12),h:dateGetter('Hours',1,-12),mm:dateGetter('Minutes',2),m:dateGetter('Minutes',1),ss:dateGetter('Seconds',2),s:dateGetter('Seconds',1),// while ISO 8601 requires fractions to be prefixed with `.` or `,`\n// we can be just safely rely on using `sss` since we currently don't support single or two digit fractions\nsss:dateGetter('Milliseconds',3),EEEE:dateStrGetter('Day'),EEE:dateStrGetter('Day',true),a:ampmGetter,Z:timeZoneGetter,ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:longEraGetter};var ZERO_CHAR='0';function dateGetter(name,size,offset,trim,negWrap){offset=offset||0;return function(date){var value=date['get'+name]();if(offset>0||value>-offset){value+=offset;}if(value===0&&offset===-12){value=12;}return padNumber(value,size,trim,negWrap);};}var uppercase=function(string){return isString(string)?string.toUpperCase():string;};function isString(value){return typeof value==='string';}function isNumber(value){return typeof value==='number';}function isDate(value){return Object.prototype.toString.call(value)==='[object Date]';}function toInt(str){return parseInt(str,10);}function dateStrGetter(name,shortForm,standAlone){return function(date,formats){var value=date['get'+name]();var propPrefix=(standAlone?'STANDALONE':'')+(shortForm?'SHORT':'');var get=uppercase(propPrefix+name);return formats[get][value];};}function timeZoneGetter(date,formats,offset){var zone=-1*offset;var paddedZone=zone>=0?'+':'';paddedZone+=padNumber(Math[zone>0?'floor':'ceil'](zone/60),2)+padNumber(Math.abs(zone%60),2);return paddedZone;}function getFirstThursdayOfYear(year){// 0 = index of January\nvar dayOfWeekOnFirst=new Date(year,0,1).getDay();// 4 = index of Thursday (+1 to account for 1st = 5)\n// 11 = index of *next* Thursday (+1 account for 1st = 12)\nreturn new Date(year,0,(dayOfWeekOnFirst<=4?5:12)-dayOfWeekOnFirst);}function getThursdayThisWeek(datetime){return new Date(datetime.getFullYear(),datetime.getMonth(),// 4 is a index of Thursday\ndatetime.getDate()+(4-datetime.getDay()));}function weekGetter(size){return function(date){var firstThurs=getFirstThursdayOfYear(date.getFullYear());var thisThurs=getThursdayThisWeek(date);var diff=Number(thisThurs)-Number(firstThurs);var result=1+Math.round(diff/6.048e8);// 6.048e8 ms per week\nreturn padNumber(result,size);};}function padNumber(num,digits,trim,negWrap){var neg='';if(num<0||negWrap&&num<=0){if(negWrap){num=-num+1;}else{num=-num;neg='-';}}num=String(num);while(num.length<digits){num=ZERO_CHAR+num;}if(trim){num=num.substr(num.length-digits);}return neg+num;}function concat(array1,array2,index){return array1.concat([].slice.call(array2,index));}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1];}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1];}function longEraGetter(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1];}var isNumberNaN=Number.isNaN||function isNumberNaN(num){return num!==num;};var ALL_COLONS=/:/g;function timezoneToOffset(timezone,fallback){// Support: IE 9-11 only, Edge 13-15+\n// IE/Edge do not \"understand\" colon (`:`) in timezone\ntimezone=timezone.replace(ALL_COLONS,'');var requestedTimezoneOffset=Date.parse('Jan 01, 1970 00:00:00 '+timezone)/60000;return isNumberNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset;}function addDateMinutes(date,minutes){date=new Date(date.getTime());date.setMinutes(date.getMinutes()+minutes);return date;}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset();var timezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);return addDateMinutes(date,reverse*(timezoneOffset-dateTimezoneOffset));}function jsonStringToDate(string){var match=string.match(R_ISO8601_STR);if(match){var date=new Date(0);var tzHour=0;var tzMin=0;var dateSetter=match[8]?date.setUTCFullYear:date.setFullYear;var timeSetter=match[8]?date.setUTCHours:date.setHours;if(match[9]){tzHour=toInt(match[9]+match[10]);tzMin=toInt(match[9]+match[11]);}dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour;var m=toInt(match[5]||0)-tzMin;var s=toInt(match[6]||0);var ms=Math.round(parseFloat('0.'+(match[7]||0))*1000);timeSetter.call(date,h,m,s,ms);return date;}return string;}function getFilteredDate(date,format,timezone){var text='';var parts=[];var fn;var match;format=format||'mediumDate';format=DATETIME_FORMATS[format]||format;if(isString(date)){date=NUMBER_STRING.test(date)?toInt(date):jsonStringToDate(date);}if(isNumber(date)){date=new Date(date);}if(!isDate(date)||!isFinite(date.getTime())){return date;}while(format){match=DATE_FORMATS_SPLIT.exec(format);if(match){parts=concat(parts,match,1);format=parts.pop();}else{parts.push(format);format=null;}}var dateTimezoneOffset=date.getTimezoneOffset();if(timezone){dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset);date=convertTimezoneToLocal(date,timezone,true);}_.forEach(parts,function(value){fn=DATE_FORMATS[value];text+=fn?fn(date,DATETIME_FORMATS,dateTimezoneOffset):value==='\\'\\''?'\\'':value.replace(/(^'|'$)/g,'').replace(/''/g,'\\'');});return text;}export default{getFilteredDate};","map":null,"metadata":{},"sourceType":"module"}