{"ast":null,"code":"// Copyright (c) 2020 Siemens\n\n/* eslint-env es6 */\n\n/**\n * @module js/splmStatsLocationService\n */\n// import { wrapFunction } from 'js/splmStatsJsService';\nimport { setReportAnalytics } from 'js/splmStatsUtils';\nconst POPSTATE = 'popState';\nconst HASHCHANGE = 'hashchange';\nlet _procs = [];\nconst globalHistoryPushState = history.pushState;\nconst globalHistoryReplaceState = history.replaceState;\n\nconst wrapFunction = function (thisArg, func) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (_procs.length === 0) {\n      return func.apply(thisArg, args);\n    }\n\n    try {\n      _procs.forEach(function (proc) {\n        proc.start();\n      });\n    } catch (ex) {// TODO: Do nothing for now, will fill it up before EOD 1905\n    }\n\n    const res = func.apply(thisArg, args);\n\n    try {\n      _procs.forEach(function (proc) {\n        proc.stop();\n      });\n    } catch (ex) {// TODO: Do nothing for now, will fill it up before EOD 1905\n    }\n\n    return res;\n  };\n};\n\nconst watcherFn = wrapFunction(null, () => null);\nexport const install = function () {\n  history.pushState = wrapFunction(history, globalHistoryPushState);\n  history.replaceState = wrapFunction(history, globalHistoryReplaceState); // instead of popstate hashchange gives the old and new url information.\n  // win.addEventListener( 'popstate', () => {\n  //     win.dispatchEvent( new Event( 'locationchange' ) );\n  // } );\n  // https://developer.mozilla.org/zh-CN/docs/Web/API/Window/onhashchange\n\n  window.addEventListener(HASHCHANGE, () => {\n    watcherFn();\n    setReportAnalytics(true);\n  });\n};\nexport const uninstall = function () {\n  history.pushState = globalHistoryPushState;\n  history.replaceState = globalHistoryReplaceState;\n  window.removeEventListener(HASHCHANGE, watcherFn);\n};\nexport const addProc = function (proc) {\n  _procs.push(proc);\n};\nexport const removeProc = function (proc) {\n  _procs = _procs.filter(procObj => proc !== procObj);\n};\nexport default {\n  install,\n  uninstall,\n  addProc,\n  removeProc\n};","map":{"version":3,"names":["setReportAnalytics","POPSTATE","HASHCHANGE","_procs","globalHistoryPushState","history","pushState","globalHistoryReplaceState","replaceState","wrapFunction","thisArg","func","args","length","apply","forEach","proc","start","ex","res","stop","watcherFn","install","window","addEventListener","uninstall","removeEventListener","addProc","push","removeProc","filter","procObj"],"sources":["C:/Users/rahukl57/Desktop/SWF/CreatingOwnComponentUsingJsx/node_modules/@swf/core/src/plstats/src/js/splmStatsLocationService.js"],"sourcesContent":["// Copyright (c) 2020 Siemens\n/* eslint-env es6 */\n\n/**\n * @module js/splmStatsLocationService\n */\n// import { wrapFunction } from 'js/splmStatsJsService';\nimport { setReportAnalytics } from 'js/splmStatsUtils';\n\nconst POPSTATE = 'popState';\nconst HASHCHANGE = 'hashchange';\n\nlet _procs = [];\n\nconst globalHistoryPushState = history.pushState;\n\nconst globalHistoryReplaceState = history.replaceState;\n\nconst wrapFunction = function( thisArg, func ) {\n    return ( ...args ) => {\n        if( _procs.length === 0 ) {\n            return func.apply( thisArg, args );\n        }\n\n        try {\n            _procs.forEach( function( proc ) {\n                proc.start();\n            } );\n        } catch ( ex ) {\n            // TODO: Do nothing for now, will fill it up before EOD 1905\n        }\n        const res = func.apply( thisArg, args );\n        try {\n            _procs.forEach( function( proc ) {\n                proc.stop();\n            } );\n        } catch ( ex ) {\n            // TODO: Do nothing for now, will fill it up before EOD 1905\n        }\n        return res;\n    };\n};\n\nconst watcherFn = wrapFunction( null, () => null );\n\nexport const install = function() {\n    history.pushState = wrapFunction( history, globalHistoryPushState );\n\n    history.replaceState = wrapFunction( history, globalHistoryReplaceState );\n\n    // instead of popstate hashchange gives the old and new url information.\n    // win.addEventListener( 'popstate', () => {\n    //     win.dispatchEvent( new Event( 'locationchange' ) );\n    // } );\n\n    // https://developer.mozilla.org/zh-CN/docs/Web/API/Window/onhashchange\n    window.addEventListener( HASHCHANGE, () => {\n        watcherFn();\n        setReportAnalytics( true );\n    } );\n};\n\nexport const uninstall = function() {\n    history.pushState = globalHistoryPushState;\n    history.replaceState = globalHistoryReplaceState;\n    window.removeEventListener( HASHCHANGE, watcherFn );\n};\n\nexport const addProc = function( proc ) {\n    _procs.push( proc );\n};\n\nexport const removeProc = function( proc ) {\n    _procs = _procs.filter( procObj => proc !== procObj );\n};\n\nexport default {\n    install,\n    uninstall,\n    addProc,\n    removeProc\n};\n"],"mappings":"AAAA;;AACA;;AAEA;AACA;AACA;AACA;AACA,SAASA,kBAAT,QAAmC,mBAAnC;AAEA,MAAMC,QAAQ,GAAG,UAAjB;AACA,MAAMC,UAAU,GAAG,YAAnB;AAEA,IAAIC,MAAM,GAAG,EAAb;AAEA,MAAMC,sBAAsB,GAAGC,OAAO,CAACC,SAAvC;AAEA,MAAMC,yBAAyB,GAAGF,OAAO,CAACG,YAA1C;;AAEA,MAAMC,YAAY,GAAG,UAAUC,OAAV,EAAmBC,IAAnB,EAA0B;EAC3C,OAAO,YAAe;IAAA,kCAAVC,IAAU;MAAVA,IAAU;IAAA;;IAClB,IAAIT,MAAM,CAACU,MAAP,KAAkB,CAAtB,EAA0B;MACtB,OAAOF,IAAI,CAACG,KAAL,CAAYJ,OAAZ,EAAqBE,IAArB,CAAP;IACH;;IAED,IAAI;MACAT,MAAM,CAACY,OAAP,CAAgB,UAAUC,IAAV,EAAiB;QAC7BA,IAAI,CAACC,KAAL;MACH,CAFD;IAGH,CAJD,CAIE,OAAQC,EAAR,EAAa,CACX;IACH;;IACD,MAAMC,GAAG,GAAGR,IAAI,CAACG,KAAL,CAAYJ,OAAZ,EAAqBE,IAArB,CAAZ;;IACA,IAAI;MACAT,MAAM,CAACY,OAAP,CAAgB,UAAUC,IAAV,EAAiB;QAC7BA,IAAI,CAACI,IAAL;MACH,CAFD;IAGH,CAJD,CAIE,OAAQF,EAAR,EAAa,CACX;IACH;;IACD,OAAOC,GAAP;EACH,CArBD;AAsBH,CAvBD;;AAyBA,MAAME,SAAS,GAAGZ,YAAY,CAAE,IAAF,EAAQ,MAAM,IAAd,CAA9B;AAEA,OAAO,MAAMa,OAAO,GAAG,YAAW;EAC9BjB,OAAO,CAACC,SAAR,GAAoBG,YAAY,CAAEJ,OAAF,EAAWD,sBAAX,CAAhC;EAEAC,OAAO,CAACG,YAAR,GAAuBC,YAAY,CAAEJ,OAAF,EAAWE,yBAAX,CAAnC,CAH8B,CAK9B;EACA;EACA;EACA;EAEA;;EACAgB,MAAM,CAACC,gBAAP,CAAyBtB,UAAzB,EAAqC,MAAM;IACvCmB,SAAS;IACTrB,kBAAkB,CAAE,IAAF,CAAlB;EACH,CAHD;AAIH,CAfM;AAiBP,OAAO,MAAMyB,SAAS,GAAG,YAAW;EAChCpB,OAAO,CAACC,SAAR,GAAoBF,sBAApB;EACAC,OAAO,CAACG,YAAR,GAAuBD,yBAAvB;EACAgB,MAAM,CAACG,mBAAP,CAA4BxB,UAA5B,EAAwCmB,SAAxC;AACH,CAJM;AAMP,OAAO,MAAMM,OAAO,GAAG,UAAUX,IAAV,EAAiB;EACpCb,MAAM,CAACyB,IAAP,CAAaZ,IAAb;AACH,CAFM;AAIP,OAAO,MAAMa,UAAU,GAAG,UAAUb,IAAV,EAAiB;EACvCb,MAAM,GAAGA,MAAM,CAAC2B,MAAP,CAAeC,OAAO,IAAIf,IAAI,KAAKe,OAAnC,CAAT;AACH,CAFM;AAIP,eAAe;EACXT,OADW;EAEXG,SAFW;EAGXE,OAHW;EAIXE;AAJW,CAAf"},"metadata":{},"sourceType":"module"}