{"ast":null,"code":"// Copyright (c) 2021 Siemens\nimport AwPopupModal from'viewmodel/AwPopupModalViewModel';import AwInclude from'viewmodel/AwIncludeViewModel';import _ from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const awPopupRenderFunction=options=>{if(!options.open){return;}let{// conditions\nhasMask,hasArrow,resizable,// children\nchildren,// controls\napi,popupReference,// displayConstraints\nwidth,height,maxHeight,maxWidth,minHeight,minWidth,innerClassName='',hasPadding,hasCloseButton,// view related\nview,subPanelContext}=options;// legacy props for awpopup2\nconst{caption,commands,anchor,isModal,context}=options;// ensure value with unit\nwidth=ensureUnit(width);height=ensureUnit(height);// this determines which template to use\nconst modal=Boolean(options.preset==='modal'||isModal||caption);const generateContent=()=>{let finalChild=children;// process view if user have a view defined\nif(view){// inject popupApi into subPanelContext, so that any sub view has full control on popup\nlet subPanelContextFinal=Object.assign({},(context===null||context===void 0?void 0:context.subPanelContext)||subPanelContext,{popupApi:api});finalChild=/*#__PURE__*/_jsx(AwInclude,{name:view,...context,subPanelContext:subPanelContextFinal});}let result=finalChild;if(modal){let finalProps={caption,commands,anchor,context,width,height};result=/*#__PURE__*/_jsx(AwPopupModal,{...finalProps,children:finalChild});}return result;};const getClassName=()=>{let result='sw-popup-contentContainer';if(hasPadding){result+=' hasPadding';}if(hasCloseButton){result+=' hasCloseButton';}if(resizable){result+=' aw-popup-enableResize';}return result;};const getResizeHandles=()=>{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"resizer-right\",onMouseDown:initResizeElement,role:\"button\",tabIndex:0}),/*#__PURE__*/_jsx(\"div\",{className:\"resizer-rightBottomCorner\",onMouseDown:initResizeElement,role:\"button\",tabIndex:0}),/*#__PURE__*/_jsx(\"div\",{className:\"resizer-bottom\",onMouseDown:initResizeElement,role:\"button\",tabIndex:0}),/*#__PURE__*/_jsx(\"div\",{className:\"resizer-left\",onMouseDown:initResizeElement,role:\"button\",tabIndex:0}),/*#__PURE__*/_jsx(\"div\",{className:\"resizer-leftBottomCorner\",onMouseDown:initResizeElement,role:\"button\",tabIndex:0})]});};const dataProps=generateDataAttribute({maxHeight,maxWidth,minHeight,minWidth});return/*#__PURE__*/_jsxs(\"div\",{\"data-locator\":\"sw-popup\",className:\"sw-popup\",ref:popupReference,children:[hasMask&&/*#__PURE__*/_jsx(\"div\",{\"data-locator\":\"sw-popup-screenMask\",className:\"sw-popup-screenMask\"}),/*#__PURE__*/_jsxs(\"div\",{\"data-locator\":\"aw-layout-popup\",className:'sw-popup-layout aw-layout-popup '+innerClassName,role:\"complementary\",children:[/*#__PURE__*/_jsxs(\"div\",{className:getClassName(),style:{width,height},...dataProps,children:[hasCloseButton&&/*#__PURE__*/_jsx(\"span\",{role:\"button\",tabIndex:\"0\",\"data-locator\":\"popup-close-button\",onKeyDown:api.hide,onClick:api.hide,className:\"aw-popup-close\",children:\"\\xD7\"}),generateContent(),getClassName().includes('aw-popup-enableResize')&&getResizeHandles()]}),hasArrow&&/*#__PURE__*/_jsx(\"div\",{\"data-locator\":\"sw-popup-arrow\",className:\"sw-popup-arrow\"})]})]});};export const initResizeElement=function(onMouseDownEvent){let minWidth=arguments.length>1&&arguments[1]!==undefined?arguments[1]:5;let minHeight=arguments.length>2&&arguments[2]!==undefined?arguments[2]:5;let initialWidth=parseInt(window.getComputedStyle(onMouseDownEvent.target.parentElement).width,10);let startHeight=parseInt(window.getComputedStyle(onMouseDownEvent.target.parentElement).height,10);var dialog=onMouseDownEvent.target.parentElement.parentElement.getBoundingClientRect();var setDialogWidth=(initialWidth,diffWidth,element)=>{let finalWidth=initialWidth+diffWidth;if(finalWidth<minWidth){finalWidth=minWidth;diffWidth=finalWidth-initialWidth;}element.style.width=finalWidth+'px';return diffWidth;};const doDrag=_.throttle(function(onDragEvent){let className=onMouseDownEvent.target.className;let element=onMouseDownEvent.target.parentElement;let parentElement=onMouseDownEvent.target.parentElement.parentElement;let startX=onMouseDownEvent.clientX;let startY=onMouseDownEvent.clientY;if(className==='resizer-right'||className==='resizer-rightBottomCorner'){let differenceWidth=onDragEvent.clientX-startX;setDialogWidth(initialWidth,differenceWidth,element);}if(className==='resizer-left'||className==='resizer-leftBottomCorner'){let differenceWidth=startX-onDragEvent.clientX;differenceWidth=setDialogWidth(initialWidth,differenceWidth,element);parentElement.style.left=dialog.left-differenceWidth+'px';}if(className==='resizer-bottom'||className==='resizer-rightBottomCorner'||className==='resizer-leftBottomCorner'){element.style.height=startHeight+onDragEvent.clientY-startY+'px';if(startHeight+onDragEvent.clientY-startY<minHeight){element.style.height=minHeight+'px';}}},50);const stopDrag=()=>{document.documentElement.removeEventListener('mousemove',doDrag,false);document.documentElement.removeEventListener('mouseup',stopDrag,false);};document.documentElement.addEventListener('mousemove',doDrag,false);document.documentElement.addEventListener('mouseup',stopDrag,false);};const generateDataAttribute=data=>{let result={};for(let key in data){let value=data[key];if(value){let key2=\"data-\".concat(key.replace(/([A-Z])/,$1=>'-'+$1.toLowerCase()));result[key2]=value;}}return result;};const ensureUnit=val=>{if(!isNaN(Number(val))){val+='px';}return val;};","map":null,"metadata":{},"sourceType":"module"}