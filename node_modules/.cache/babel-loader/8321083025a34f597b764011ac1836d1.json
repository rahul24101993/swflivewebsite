{"ast":null,"code":"import AwCommand from'viewmodel/AwCommandViewModel';import AwExtendedTooltip from'viewmodel/AwExtendedTooltipViewModel';import AwIcon from'viewmodel/AwIconViewModel';import AwPopup from'viewmodel/AwPopupViewModel';import AwPopupCommandCell from'viewmodel/AwPopupCommandCellViewModel';import{getCommandStates}from'js/command.service';import{getCompClass}from'js/componentUtils';/**\n * Configuration for the overflow popup\n */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const overflowPopupOptions={advancePositioning:true,autoFocus:true,clickOutsideToClose:true,closeWhenEsc:true,flipBehavior:'opposite',resizeContainer:'div.aw-layout-popup',selectedElementCSS:'.aw-state-selected',toggleMode:true,whenParentScrolls:'follow',forceCloseOthers:false};/**\n * Get any class to use based on the \"showCommandLabels\" option\n *\n * @param {Boolean} showCommandLabels true/false\n * @returns {String} Class to use\n */const getCommandLabelClass=showCommandLabels=>{if(showCommandLabels===false){return'aw-commands-noLabel';}if(showCommandLabels===true){return'aw-commands-showIconLabel';}return'';};export const awToolbarInternalRenderFunction=_ref=>{let{alignment,visibilityLoader,commandContext,firstAnchor,secondAnchor,ctxMin:{firstCommandDisplays:fcd,secondCommandDisplays:scd},className,showCommandLabels,elementRefList,overflow,hideMore,trace=()=>null,reverse=false,reverseSecond=false,actions:{overflowPopup},i18n,viewModel:{_observer,_overflownCommands}}=_ref;//Reverse the second cmd displays for backward compibility with ng\nscd=scd.reverse();const firstCommandDisplays=reverse?fcd.reverse():fcd;let secondCommandDisplays=reverseSecond?scd.reverse():scd;const alignmentCls=alignment==='VERTICAL'?'aw-commands-commandBarVertical':'aw-commands-commandBarHorizontal';const commandLabelsClass=getCommandLabelClass(showCommandLabels);const commandBarMain=elementRefList.get('commandBarMain');const childCommandClickCallback=hasPopup=>{if(hasPopup){return;}overflowPopup.hide();};// give vertical toolbar a default background color\nconst orientationCls=alignment==='VERTICAL'?' aw-toolbar-vertical aw-layout-infoCommandbar':' aw-toolbar-horizontal';const renderCommand=command=>{return/*#__PURE__*/_jsx(AwCommand,{commandContext:commandContext,command:command,alignment:alignment,visibilityLoader:visibilityLoader,commandObserver:_observer,overflow:_overflownCommands[command.id]?true:null},command&&command.id);};const isVisible=command=>command&&command.visible;const renderVerticalContent=(alignmentCls,secondBarClass,firstAnchor,secondAnchor,renderOverflowButton,overflownCommandsCount)=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"aw-commandBars aw-commandBar-vertical\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sw-row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-command-bar \".concat(alignmentCls),anchor:firstAnchor,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-commands-wrapper \".concat(commandLabelsClass,\" aw-no-overflow\"),children:renderOverflowButton?_observer&&firstCommandDisplays.filter(isVisible).map(renderCommand):firstCommandDisplays.filter(isVisible).map(renderCommand)})})}),/*#__PURE__*/_jsx(\"div\",{className:\"sw-row aw-bottom-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-command-bar \".concat(alignmentCls,\" \").concat(secondBarClass),anchor:secondAnchor,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-commands-wrapper \".concat(commandLabelsClass,\" aw-no-overflow\"),children:renderOverflowButton?_observer&&secondCommandDisplays.filter(isVisible).map(renderCommand):secondCommandDisplays.filter(isVisible).map(renderCommand)})})}),renderOverflowButton&&overflownCommandsCount?renderOverflowButton():null]});};const renderWithOverflow=()=>{let overflownCommandsCount=0;const isVisibleCmd=cmd=>{if(cmd&&cmd.visible){_overflownCommands[cmd.id]&&overflownCommandsCount++;return true;}return null;};const secondBarClass=alignment==='VERTICAL'?'aw-second-barVertical':'aw-second-barHorizontal';const firstVisibleCommands=firstCommandDisplays.filter(isVisibleCmd);const secondVisibleCommands=secondCommandDisplays.filter(isVisibleCmd);const visibleCommandCount=firstVisibleCommands.length+secondVisibleCommands.length;trace(\"\".concat(visibleCommandCount,\" commands are visible, computing command overflow\"));const overflowClickHandler=e=>{e.stopPropagation();if(overflowPopup.open){overflowPopup.hide();}else{overflowPopup.show({...overflowPopupOptions,placement:alignment==='VERTICAL'?'left-start':'bottom-start'});}};const getOverflownCommands=()=>{let firstOverflownCmds=[];let secondOverflownCmds=[];for(const cmdId in _overflownCommands){let overflownCmd=firstVisibleCommands.find(command=>command&&command.id===cmdId);if(!overflownCmd){overflownCmd=secondVisibleCommands.find(command=>command&&command.id===cmdId);overflownCmd&&secondOverflownCmds.unshift(overflownCmd);}else{firstOverflownCmds.unshift(overflownCmd);}}return firstOverflownCmds.concat(secondOverflownCmds);};const renderOverflowPopup=()=>{return overflowPopup.open&&/*#__PURE__*/_jsx(AwPopup,{...overflowPopup.options,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-popup-command-bar\",children:getOverflownCommands().map(command=>/*#__PURE__*/_jsx(AwPopupCommandCell,{commandContext:commandContext,command:command,alignment:alignment,visibilityLoader:visibilityLoader,overflow:true,childCommandClickCallback:childCommandClickCallback},command&&command.id))})});};const renderOverflowButton=()=>{return/*#__PURE__*/_jsxs(\"div\",{className:'aw-toolbarIcon aw-commands-moreButton aw-command-overflowIcon',children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"aw-commands-commandToolbarIconButton \".concat(overflowPopup.open?'aw-state-selected':''),\"aria-label\":i18n.MORE_BUTTON_TITLE,onClick:overflowClickHandler,ref:overflowPopup.reference,children:/*#__PURE__*/_jsx(AwIcon,{iconId:\"cmdMore\",className:\"aw-commands-svg\"})}),/*#__PURE__*/_jsx(AwExtendedTooltip,{reference:overflowPopup.reference,extendedTooltipContext:{title:i18n.MORE_BUTTON_TITLE},extendedTooltipOptions:{isCommand:true,placement:'left'}})]});};const renderHorizontalContent=()=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"aw-commandBars aw-commandBar-horizontal\",children:[firstVisibleCommands.length?/*#__PURE__*/_jsx(\"div\",{className:\"aw-command-bar aw-use-commandOverflow \".concat(alignmentCls),anchor:firstAnchor,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-commands-wrapper \".concat(commandLabelsClass,\" aw-no-overflow\"),children:_observer&&firstVisibleCommands.map(renderCommand)})}):/*#__PURE__*/_jsx(\"div\",{className:\"aw-commandBars aw-commandBar-horizontal\"}),secondVisibleCommands.length?/*#__PURE__*/_jsx(\"div\",{className:\"aw-command-bar aw-use-commandOverflow \".concat(alignmentCls,\" \").concat(secondBarClass),anchor:secondAnchor,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-commands-wrapper \".concat(commandLabelsClass,\" aw-no-overflow\"),children:_observer&&secondVisibleCommands.map(renderCommand)})}):null,overflownCommandsCount?renderOverflowButton():null]});};return/*#__PURE__*/_jsxs(\"div\",{className:getCompClass('aw-toolbar-layout',{className})+' '+orientationCls,ref:commandBarMain,children:[alignment==='VERTICAL'?renderVerticalContent(alignmentCls,secondBarClass,firstAnchor,secondAnchor,renderOverflowButton,overflownCommandsCount):renderHorizontalContent(),renderOverflowPopup()]});};const renderToolbarNoOverflow=()=>{const cmdBarOrientationCls=alignment==='VERTICAL'?'aw-commandBar-vertical':'aw-commandBar-horizontal';const secondBarClass=alignment==='VERTICAL'?'aw-second-barVertical':'aw-second-barHorizontal';return/*#__PURE__*/_jsx(\"div\",{className:getCompClass('aw-toolbar-layout aw-toolbar-nooverflow',{className})+' '+orientationCls,ref:commandBarMain,children:alignment==='VERTICAL'?renderVerticalContent(alignmentCls,secondBarClass,firstAnchor,secondAnchor,null):/*#__PURE__*/_jsxs(\"div\",{className:'aw-commandBars '+cmdBarOrientationCls,children:[/*#__PURE__*/_jsx(\"div\",{className:\"aw-command-bar \".concat(alignmentCls,\" \"),anchor:firstAnchor,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-commands-wrapper \".concat(commandLabelsClass,\" aw-no-overflow\"),children:firstCommandDisplays.filter(isVisible).map(renderCommand)})}),/*#__PURE__*/_jsx(\"div\",{className:\"aw-command-bar \".concat(alignmentCls,\"  \").concat(secondBarClass),anchor:secondAnchor,children:/*#__PURE__*/_jsx(\"div\",{className:\"aw-commands-wrapper \".concat(commandLabelsClass,\" aw-no-overflow\"),children:secondCommandDisplays.filter(isVisible).map(renderCommand)})})]})});};if(overflow&&overflow!=='false'){return renderWithOverflow();}return renderToolbarNoOverflow();};/**\n * Derived state config for first set of CommandOverlay\n *\n * @param {*} vmDef vmDef\n * @param {*} param1 param1\n * @returns {[DerivedStateResult]} result\n */export const getFirstCommandStates=(vmDef,_ref2)=>{let{firstCommandList=[],commandContext={},visibleServerCommands={}}=_ref2;return getCommandStates(vmDef,{commandList:firstCommandList,commandContext,visibleServerCommands});};/**\n * Derived state config for second set of CommandOverlay\n *\n * @param {*} vmDef vmDef\n * @param {*} param1 param1\n * @returns {[DerivedStateResult]} result\n */export const getSecondCommandStates=(vmDef,_ref3)=>{let{secondCommandList=[],commandContext={},visibleServerCommands={}}=_ref3;return getCommandStates(vmDef,{commandList:secondCommandList,commandContext,visibleServerCommands});};","map":null,"metadata":{},"sourceType":"module"}