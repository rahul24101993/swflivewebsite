{"code":"(this.webpackJsonpcreatingjsxcomponent=this.webpackJsonpcreatingjsxcomponent||[]).push([[96],{3040:function(e,t,a){\"use strict\";a.r(t),a.d(t,\"setAutoSaveToggle\",(function(){return S})),a.d(t,\"onChangeCallback\",(function(){return h})),a.d(t,\"initializeAutoSaveContext\",(function(){return b})),a.d(t,\"autoSaveContextRenderFunction\",(function(){return T}));var o=a(12),n=a(65),u=a(32),i=a(101),l=a(15),d=a(7),s=a(1),c=a.n(s),r=a(605),f=a(599),g=a(45),p=a(2);const v=\"autoSave.dbValue\";let x;const C=Object(g.i)(f.default),S=function(e){void 0===x&&o.default.updatePartialCtx(v,e)},h=function(e){return function(t){e.onChange&&e.onChange(t);const a=o.default.getCtx(v);e.update(!a),n.a.leaveConfirmation().then((()=>{e.update(a),u.default.publish(\"autosave\",a),d.a.publish(\"autoSaveToggleChanged\",a)}))}},b=async function(){let e=!0;o.default.registerCtx(\"showAutoSaveToggle\",!0);const t=u.default.get(\"autosave\");\"true\"!==t&&\"false\"!==t||(e=\"true\"===t),d.a.subscribe(\"appCtx.update\",(function(e){\"workspace\"===e.name&&(x=c.a.get(e.value,\"settings.autoSave\"),void 0!==x&&(S(x),o.default.updateCtx(\"showAutoSaveToggle\",!1)))}));const a=await l.default.getLocalizedTextFromKey(\"BaseMessages.AUTO_SAVE_TITLE\",!0);o.default.registerCtx(\"autoSave\",i.a.createViewModelProperty({displayName:a,type:\"BOOLEAN\",dbValue:e}))},T=e=>{let{actions:t,viewModel:a,fields:o}=e;const{data:n}=a;return o.autoSave&&o.autoSave.fielddata&&(o.autoSave.fielddata.labelPlacement=\"start\"),Object(p.jsx)(r.default,{children:Object(p.jsx)(C,{...o.autoSave,onChange:h(o.autoSave),extendedTooltipOptions:\"{alignment : 'top'}\",extendedTooltipContext:n.tooltip,extendedTooltip:\"ExtendedTooltipDefault\"})})};t.default={initializeAutoSaveContext:b,setAutoSaveToggle:S,onChangeCallback:h,autoSaveContextRenderFunction:T}}}]);","name":"static/js/96.92ff09cf.chunk.js","input":"(this[\"webpackJsonpcreatingjsxcomponent\"] = this[\"webpackJsonpcreatingjsxcomponent\"] || []).push([[96],{\n\n/***/ 3040:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setAutoSaveToggle\", function() { return setAutoSaveToggle; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"onChangeCallback\", function() { return onChangeCallback; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initializeAutoSaveContext\", function() { return initializeAutoSaveContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"autoSaveContextRenderFunction\", function() { return autoSaveContextRenderFunction; });\n/* harmony import */ var js_appCtxService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(12);\n/* harmony import */ var js_editHandlerService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(65);\n/* harmony import */ var js_localStorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(32);\n/* harmony import */ var js_modelPropertyService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(101);\n/* harmony import */ var js_localeService__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(15);\n/* harmony import */ var js_eventBus__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(7);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(1);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var viewmodel_AwColumnViewModel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(605);\n/* harmony import */ var viewmodel_AwTogglebuttonViewModel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(599);\n/* harmony import */ var js_hocCollection__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(45);\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(2);\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__);\n// Copyright (c) 2020 Siemens\n/**\n * @module js/autoSaveContextService\n */const AUTO_SAVE_CTX_PATH='autoSave.dbValue';let autoSaveWorkspaceValue;const AwToggleButtonHOC=Object(js_hocCollection__WEBPACK_IMPORTED_MODULE_9__[/* ExtendedTooltip */ \"i\"])(viewmodel_AwTogglebuttonViewModel__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);/**\n * API to update the autoSave mode\n *\n * @param {Boolean} enable - true if autoSave should be enabled\n */const setAutoSaveToggle=function(enable){// Do not update value if workspace override is being used\nif(autoSaveWorkspaceValue!==undefined){return;}js_appCtxService__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updatePartialCtx(AUTO_SAVE_CTX_PATH,enable);};/**\n * API to trigger leaveConfirmation, update local storage, and announce changes when the toggle changes\n * @param {Object} prop - the property field\n */const onChangeCallback=function(prop){return function(event){if(prop.onChange){prop.onChange(event);}// Revert toggle value until leave confirmation is finished\nconst currentToggleValue=js_appCtxService__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getCtx(AUTO_SAVE_CTX_PATH);prop.update(!currentToggleValue);js_editHandlerService__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"].leaveConfirmation().then(()=>{// Apply new toggle value\nprop.update(currentToggleValue);// setAutoSaveToggle( currentToggleValue );\n// Update local storage so user value can be persisted\njs_localStorage__WEBPACK_IMPORTED_MODULE_2__[\"default\"].publish('autosave',currentToggleValue);// Publish event announcing the new value\njs_eventBus__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"].publish('autoSaveToggleChanged',currentToggleValue);});};};/**\n * API to handler workpace updates in ctx. When workspace is updated this api\n * will check for an autosave override. If the override is given the auto save mode will\n * be updated and the auto save toggle will be hidden in the UI.\n */const handleWorkspaceAutoSaveSetting=function(){// Overwrite overwrite and hide toggle if workspace override exists\njs_eventBus__WEBPACK_IMPORTED_MODULE_5__[/* default */ \"a\"].subscribe('appCtx.update',function(event){if(event.name==='workspace'){autoSaveWorkspaceValue=lodash__WEBPACK_IMPORTED_MODULE_6___default.a.get(event.value,'settings.autoSave');if(autoSaveWorkspaceValue!==undefined){setAutoSaveToggle(autoSaveWorkspaceValue);// Hide autosave toggle if workspace override is in use\njs_appCtxService__WEBPACK_IMPORTED_MODULE_0__[\"default\"].updateCtx('showAutoSaveToggle',false);}}});};/**\n * Sets up autosave in appCtx. Priority is workspace override followed by local storage.\n */const initializeAutoSaveContext=async function(){// The autoSave context initial value will be true unless local storage or workspace override exists\nlet initialAutoSaveValue=true;js_appCtxService__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerCtx('showAutoSaveToggle',true);// Apply value from local storage if it exists\nconst autoSaveLocalStorageValue=js_localStorage__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get('autosave');if(autoSaveLocalStorageValue==='true'||autoSaveLocalStorageValue==='false'){initialAutoSaveValue=autoSaveLocalStorageValue==='true';}// Aply workspace override if it exists\nhandleWorkspaceAutoSaveSetting();// Apply initial value to ctx\nconst displayName=await js_localeService__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getLocalizedTextFromKey('BaseMessages.AUTO_SAVE_TITLE',true);js_appCtxService__WEBPACK_IMPORTED_MODULE_0__[\"default\"].registerCtx('autoSave',js_modelPropertyService__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"].createViewModelProperty({displayName:displayName,type:'BOOLEAN',dbValue:initialAutoSaveValue}));};const autoSaveContextRenderFunction=_ref=>{let{actions,viewModel,fields}=_ref;const{data}=viewModel;if(fields.autoSave&&fields.autoSave.fielddata){fields.autoSave.fielddata.labelPlacement='start';}return/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__[\"jsx\"])(viewmodel_AwColumnViewModel__WEBPACK_IMPORTED_MODULE_7__[\"default\"],{children:/*#__PURE__*/Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__[\"jsx\"])(AwToggleButtonHOC,{...fields.autoSave,onChange:onChangeCallback(fields.autoSave),extendedTooltipOptions:\"{alignment : 'top'}\",extendedTooltipContext:data.tooltip,extendedTooltip:\"ExtendedTooltipDefault\"})});};/* harmony default export */ __webpack_exports__[\"default\"] = ({initializeAutoSaveContext,setAutoSaveToggle,onChangeCallback,autoSaveContextRenderFunction});\n\n/***/ })\n\n}]);","inputSourceMap":null}